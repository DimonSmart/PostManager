# Задание 1. UI-конвенции CRUD, раздельные страницы и переход на MudBlazor

Дата: 2026-01-15  
Статус: Согласовано (для внедрения)  
Область: UI / Frontend (Blazor)

---

## 1. Контекст и проблема

Сейчас страницы сущностей (на примере **Campaigns**) совмещают:
- список существующих элементов
- форму создания нового элемента

Для сущностей с большим количеством параметров (Campaign и аналогичные) это неудобно:
- форма занимает только часть ширины, ухудшается читаемость и навигация
- возрастает вертикальная прокрутка
- паттерн плохо масштабируется и становится одинаково неудобным для всех сущностей

---

## 2. Цель

1) Разделить **страницу списка** и **страницы создания/редактирования** для **всех сущностей**.  
2) Перейти на использование **MudBlazor** как основной UI-библиотеки.  
3) Зафиксировать эти решения в документации проекта как обязательные требования.

---

## 3. Общая UI-конвенция CRUD (для всех сущностей)

### 3.1 Страница списка
Маршрут: `/entities` (пример: `/campaigns`)

Содержит:
- таблицу/грид со списком элементов
- действия на элементе: **Edit**, **Delete**
- кнопку **Create** (создание нового элемента)

Требования:
- **создание не выполняется на странице списка**
- **удаление только с подтверждением** через диалог

### 3.2 Страница создания
Маршрут: `/entities/new` (пример: `/campaigns/new`)

Содержит:
- полноширинную форму (использовать всю ширину контентной области)
- кнопки: **Create**, **Cancel**

### 3.3 Страница редактирования
Маршрут: `/entities/{id}` (пример: `/campaigns/{id}`)

Содержит:
- ту же форму и поля, что и при создании
- кнопки: **Save**, **Cancel/Back**

---

## 4. Переиспользование формы Create/Edit

Так как для большинства сущностей поля создания и редактирования совпадают, форма должна быть переиспользуемой:

- выделить общий компонент формы (например, `EntityForm`)
- режим работы определяется наличием `id`:
  - `id` отсутствует → режим **Create**
  - `id` присутствует → режим **Edit** (данные подгружаются по `id`)

Логика заполнения, валидации и отображения полей может быть общей для создания и редактирования
(если специально не указаны отличия)

---

## 5. Переходы после создания (выбранный вариант)

Выбран вариант **1 (Query-string)**.

### 5.1 Правило
После успешного создания на странице `/entities/new`:
- выполнить переход на страницу списка: `/entities`
- в URL передать `selectedId`:
  - пример: `/campaigns?selectedId={newId}`

### 5.2 Поведение страницы списка
Страница списка при наличии `selectedId`:
- автоматически выделяет (highlight/selected) строку с `Id == selectedId`
- при необходимости прокручивает список к выбранной строке (если строка вне видимой области)
- опционально показывает уведомление (toast/snackbar) “Created”

---

## 6. Удаление элементов

Удаление должно выполняться только после подтверждения:
- действие **Delete** открывает диалог подтверждения (MudDialog)
- в диалоге явно указать сущность/название удаляемого элемента
- после подтверждения выполняется удаление и обновление списка
- после отмены диалог закрывается без изменений

---

## 7. MudBlazor как стандарт UI

### 7.1 Требование
В проекте должна использоваться библиотека **MudBlazor** как основная UI-библиотека.

### 7.2 Рекомендации по компонентам
- списки: `MudTable` (или `MudDataGrid`, если нужен расширенный грид)
- формы: `MudForm`, `MudTextField`, `MudSelect`, `MudNumericField`, `MudSwitch/MudCheckBox`
- уведомления: `MudSnackbar`
- диалоги: `MudDialog`

---

## 8. Объем работ

1) Обновить UI-шаблон для всех сущностей:
- List page отдельно
- Create page отдельно
- Edit page отдельно
- общий компонент формы Create/Edit

2) Внедрить выбранное поведение после Create через query-string:
- `selectedId` в URL списка
- выделение строки и прокрутка к ней

3) Кампания (Campaigns) делается первой (как референс-реализация), затем конвенция переносится на остальные сущности.

---

## 9. Критерии приемки

1) На страницах списков **нет** встроенных форм создания.
2) Создание доступно только на `/entities/new`.
3) Редактирование доступно только на `/entities/{id}`.
4) Удаление возможно только после подтверждения в диалоге.
5) После Create происходит редирект на список с `selectedId`, и в списке выделен созданный элемент.
6) Формы и списки реализованы на MudBlazor.
7) Описание этих правил добавлено в документацию проекта и применяется единообразно.

---

## 10. Примечания

- Для безопасности запрещается произвольный redirect по URL. Используется только `selectedId` (query-string) на странице списка, без “returnUrl”.
- Если элемент с `selectedId` не найден (удален/фильтр/пагинация), система не падает: выделение не применяется, список отображается нормально.
